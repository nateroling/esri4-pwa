"use strict";var oe=Object.defineProperty,le=Object.defineProperties,ue=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable,ae=(O,A,m)=>A in O?oe(O,A,{enumerable:!0,configurable:!0,writable:!0,value:m}):O[A]=m,ne=(O,A)=>{for(var m in A||(A={}))ce.call(A,m)&&ae(O,m,A[m]);if(ie)for(var m of ie(A))ve.call(A,m)&&ae(O,m,A[m]);return O},se=(O,A)=>le(O,ue(A));(self.webpackChunkesri4_pwa=self.webpackChunkesri4_pwa||[]).push([[3022,3100],{11915:(O,A,m)=>{m.d(A,{e:()=>N});var M,V,k={exports:{}};M=k,void 0!==(V=function(){function D(e,t,r){r=r||2;var n,s,o,u,p,I,Z,te=t&&t.length,$=te?t[0]*r:e.length,B=U(e,0,$,r,!0),F=[];if(!B||B.next===B.prev)return F;if(te&&(B=function K(e,t,r,n){var s,o,u,p=[];for(s=0,o=t.length;s<o;s++)(u=U(e,t[s]*n,s<o-1?t[s+1]*n:e.length,n,!1))===u.next&&(u.steiner=!0),p.push(re(u));for(p.sort(q),s=0;s<p.length;s++)r=_(r=ee(p[s],r),r.next);return r}(e,t,B,r)),e.length>80*r){n=o=e[0],s=u=e[1];for(var C=r;C<$;C+=r)(p=e[C])<n&&(n=p),(I=e[C+1])<s&&(s=I),p>o&&(o=p),I>u&&(u=I);Z=0!==(Z=Math.max(o-n,u-s))?1/Z:0}return w(B,F,r,n,s,Z),F}function U(e,t,r,n,s){var o,u;if(s===E(e,t,r,n)>0)for(o=t;o<r;o+=n)u=L(o,e[o],e[o+1],u);else for(o=r-n;o>=t;o-=n)u=L(o,e[o],e[o+1],u);if(u&&c(u,u.next)){var p=u.next;i(u),u=p}return u}function _(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!c(n,n.next)&&0!==d(n.prev,n,n.next))n=n.next;else{var s=n.prev;if(i(n),(n=t=s)===n.next)break;r=!0}}while(r||n!==t);return t}function w(e,t,r,n,s,o,u){if(e){!u&&o&&function P(e,t,r,n){var s=e;do{null===s.z&&(s.z=Q(s.x,s.y,t,r,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,function j(e){var t,r,n,s,o,u,p,I,Z=1;do{for(r=e,e=null,o=null,u=0;r;){for(u++,n=r,p=0,t=0;t<Z&&(p++,n=n.nextZ);t++);for(I=Z;p>0||I>0&&n;)0!==p&&(0===I||!n||r.z<=n.z)?(s=r,r=r.nextZ,p--):(s=n,n=n.nextZ,I--),o?o.nextZ=s:e=s,s.prevZ=o,o=s;r=n}o.nextZ=null,Z*=2}while(u>1)}(s)}(e,n,s,o);for(var p,I,Z=e;e.prev!==e.next;)if(p=e.prev,I=e.next,o?W(e,n,s,o):x(e))t.push(p.i/r),t.push(e.i/r),t.push(I.i/r),i(e),e=I.next,Z=I.next;else if((e=I)===Z){u?1===u?w(e=J(_(e),t,r),t,r,n,s,o,2):2===u&&Y(e,t,r,n,s,o):w(_(e),t,r,n,s,o,1);break}}}function x(e){var t=e.prev,r=e,n=e.next;if(d(t,r,n)>=0)return!1;for(var s=e.next.next;s!==e.prev;){if(G(t.x,t.y,r.x,r.y,n.x,n.y,s.x,s.y)&&d(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function W(e,t,r,n){var s=e.prev,o=e,u=e.next;if(d(s,o,u)>=0)return!1;for(var Z=s.x>o.x?s.x>u.x?s.x:u.x:o.x>u.x?o.x:u.x,te=s.y>o.y?s.y>u.y?s.y:u.y:o.y>u.y?o.y:u.y,$=Q(s.x<o.x?s.x<u.x?s.x:u.x:o.x<u.x?o.x:u.x,s.y<o.y?s.y<u.y?s.y:u.y:o.y<u.y?o.y:u.y,t,r,n),B=Q(Z,te,t,r,n),F=e.prevZ,C=e.nextZ;F&&F.z>=$&&C&&C.z<=B;){if(F!==e.prev&&F!==e.next&&G(s.x,s.y,o.x,o.y,u.x,u.y,F.x,F.y)&&d(F.prev,F,F.next)>=0||(F=F.prevZ,C!==e.prev&&C!==e.next&&G(s.x,s.y,o.x,o.y,u.x,u.y,C.x,C.y)&&d(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;F&&F.z>=$;){if(F!==e.prev&&F!==e.next&&G(s.x,s.y,o.x,o.y,u.x,u.y,F.x,F.y)&&d(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;C&&C.z<=B;){if(C!==e.prev&&C!==e.next&&G(s.x,s.y,o.x,o.y,u.x,u.y,C.x,C.y)&&d(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function J(e,t,r){var n=e;do{var s=n.prev,o=n.next.next;!c(s,o)&&l(s,n,n.next,o)&&b(s,o)&&b(o,s)&&(t.push(s.i/r),t.push(n.i/r),t.push(o.i/r),i(n),i(n.next),n=e=o),n=n.next}while(n!==e);return _(n)}function Y(e,t,r,n,s,o){var u=e;do{for(var p=u.next.next;p!==u.prev;){if(u.i!==p.i&&S(u,p)){var I=z(u,p);return u=_(u,u.next),I=_(I,I.next),w(u,t,r,n,s,o),void w(I,t,r,n,s,o)}p=p.next}u=u.next}while(u!==e)}function q(e,t){return e.x-t.x}function X(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function ee(e,t){var r=function H(e,t){var r,n=t,s=e.x,o=e.y,u=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var p=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(p<=s&&p>u){if(u=p,p===s){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(s===u)return r;var I,Z=r,te=r.x,$=r.y,B=1/0;n=r;do{s>=n.x&&n.x>=te&&s!==n.x&&G(o<$?s:u,o,te,$,o<$?u:s,o,n.x,n.y)&&(I=Math.abs(o-n.y)/(s-n.x),b(n,e)&&(I<B||I===B&&(n.x>r.x||n.x===r.x&&R(r,n)))&&(r=n,B=I)),n=n.next}while(n!==Z);return r}(e,t);if(!r)return t;var n=z(r,e),s=_(r,r.next);let o=X(n);return _(o,o.next),s=X(s),X(t===r?s:t)}function R(e,t){return d(e.prev,e,t.prev)<0&&d(t.next,e,e.next)<0}function Q(e,t,r,n,s){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*s)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function re(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function G(e,t,r,n,s,o,u,p){return(s-u)*(t-p)-(e-u)*(o-p)>=0&&(e-u)*(n-p)-(r-u)*(t-p)>=0&&(r-u)*(o-p)-(s-u)*(n-p)>=0}function S(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function y(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&l(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(b(e,t)&&b(t,e)&&function g(e,t){var r=e,n=!1,s=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&s<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(d(e.prev,e,t.prev)||d(e,t.prev,t))||c(e,t)&&d(e.prev,e,e.next)>0&&d(t.prev,t,t.next)>0)}function d(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function c(e,t){return e.x===t.x&&e.y===t.y}function l(e,t,r,n){var s=h(d(e,t,r)),o=h(d(e,t,n)),u=h(d(r,n,e)),p=h(d(r,n,t));return s!==o&&u!==p||!(0!==s||!f(e,r,t))||!(0!==o||!f(e,n,t))||!(0!==u||!f(r,e,n))||!(0!==p||!f(r,t,n))}function f(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function h(e){return e>0?1:e<0?-1:0}function b(e,t){return d(e.prev,e,e.next)<0?d(e,t,e.next)>=0&&d(e,e.prev,t)>=0:d(e,t,e.prev)<0||d(e,e.next,t)<0}function z(e,t){var r=new v(e.i,e.x,e.y),n=new v(t.i,t.x,t.y),s=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=s,s.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function L(e,t,r,n){var s=new v(e,t,r);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function i(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function v(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,t,r,n){for(var s=0,o=t,u=r-n;o<r;o+=n)s+=(e[u]-e[o])*(e[o+1]+e[u+1]),u=o;return s}return D.deviation=function(e,t,r,n){var s=t&&t.length,u=Math.abs(E(e,0,s?t[0]*r:e.length,r));if(s)for(var p=0,I=t.length;p<I;p++)u-=Math.abs(E(e,t[p]*r,p<I-1?t[p+1]*r:e.length,r));var $=0;for(p=0;p<n.length;p+=3){var B=n[p]*r,F=n[p+1]*r,C=n[p+2]*r;$+=Math.abs((e[B]-e[C])*(e[F+1]-e[B+1])-(e[B]-e[F])*(e[C+1]-e[B+1]))}return 0===u&&0===$?0:Math.abs(($-u)/u)},D.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,s=0;s<e.length;s++){for(var o=0;o<e[s].length;o++)for(var u=0;u<t;u++)r.vertices.push(e[s][o][u]);s>0&&r.holes.push(n+=e[s-1].length)}return r},D}())&&(M.exports=V);const N=k.exports},83100:(O,A,m)=>{function M(w){return w=w||globalThis.location.hostname,_.some(x=>{var W;return null!=(null==(W=w)?void 0:W.match(x))})}function T(w,x){return w&&(x=x||globalThis.location.hostname)?null!=x.match(k)||null!=x.match(D)?w.replace("static.arcgis.com","staticdev.arcgis.com"):null!=x.match(N)||null!=x.match(U)?w.replace("static.arcgis.com","staticqa.arcgis.com"):w:w}m.d(A,{pJ:()=>T,XO:()=>M});const k=/^devext.arcgis.com$/,N=/^qaext.arcgis.com$/,D=/^[\w-]*\.mapsdevext.arcgis.com$/,U=/^[\w-]*\.mapsqa.arcgis.com$/,_=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,k,N,/^jsapps.esri.com$/,D,U]},43289:(O,A,m)=>{m.d(A,{vX:()=>H,s5:()=>K,k3:()=>q,Or:()=>Y});const N=128/Math.PI,W=1/Math.LN2;function J(R,P){return(R%=P)>=0?R:R+P}function Y(R){return J(R*N,256)}function K(R){return J(.7111111111111111*R,256)}function q(R){return Math.log(R)*W}function H(R,P,j){return R>=P&&R<=j||R>=j&&R<=P}},61261:(O,A,m)=>{var M,T,x;function V(x){switch(x){case"left":return M.Left;case"right":return M.Right;case"center":case"justify":return M.Center}}function k(x){switch(x){case"top":return T.Top;case"middle":return T.Center;case"baseline":return T.Baseline;case"bottom":return T.Bottom}}function N(x){switch(x){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[M.Right,T.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[M.Center,T.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[M.Left,T.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[M.Right,T.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[M.Center,T.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[M.Left,T.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[M.Right,T.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[M.Center,T.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[M.Left,T.Top];default:return console.debug(`Found invalid placement type ${x}`),[M.Center,T.Center]}}function D(x){switch(x){case M.Right:return-1;case M.Center:return 0;case M.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${x}`),0}}function U(x){switch(x){case T.Top:return 1;case T.Center:return 0;case T.Bottom:case T.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${x}`),0}}function _(x){switch(x){case"left":return M.Left;case"right":return M.Right;case"center":case"justify":return M.Center}}function w(x){switch(x){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}m.d(A,{M7:()=>M,TR:()=>T,qv:()=>N,Hd:()=>_,kH:()=>V,g:()=>D,b7:()=>k,tf:()=>U,NS:()=>w}),(x=M||(M={}))[x.Left=-1]="Left",x[x.Center=0]="Center",x[x.Right=1]="Right",function(x){x[x.Top=1]="Top",x[x.Center=0]="Center",x[x.Bottom=-1]="Bottom",x[x.Baseline=2]="Baseline"}(T||(T={}))},18716:(O,A,m)=>{m.d(A,{dk:()=>h,Gq:()=>z,a:()=>b,mE:()=>y,m2:()=>S,qr:()=>g,jj:()=>re});var M=m(26584),T=m(61261),V=m(39406);function re(L,i){switch(L){case V.LW.FILL:return h.from(i);case V.LW.LINE:return b.from(i);case V.LW.MARKER:return y.from(i);case V.LW.TEXT:return g.from(i);case V.LW.LABEL:return z.from(i);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${L}`)}}class S{constructor(i){this._data=0,this._data=i}static load(i){const v=this.shared;return v.data=i,v}set data(i){this._data=i}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(i){this.setBits(i,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(i){this.setBit(20,i)}get sdf(){return!!this.bit(11)}set sdf(i){this.setBit(11,i)}get pattern(){return!!this.bit(12)}set pattern(i){this.setBit(12,i)}get textureBinding(){return this.bits(0,8)}set textureBinding(i){this.setBits(i,0,8)}get geometryTypeString(){switch(this.geometryType){case V.LW.FILL:return"fill";case V.LW.MARKER:return"marker";case V.LW.LINE:return"line";case V.LW.TEXT:return"text";case V.LW.LABEL:return"label";default:throw new M.Z(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(i,v){const E=1<<i;v?this._data|=E:this._data&=~E}bit(i){return(this._data&1<<i)>>i}setBits(i,v,E){for(let e=v,t=0;e<E;e++,t++)this.setBit(e,0!=(i&1<<t))}bits(i,v){let E=0;for(let e=i,t=0;e<v;e++,t++)E|=this.bit(e)<<t;return E}hasVV(){return!1}setVV(i,v){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}getVariationHash(){return this._data&~(7&this.textureBinding)}}S.shared=new S(0);const d=L=>class extends L{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(i){this.setBit(16,i)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(i){this.setBit(17,i)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(i){this.setBit(18,i)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(i){this.setBit(19,i)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(i,v){super.setVV(i,v);const E=function k(L,i){const v=V.X.SIZE_FIELD_STOPS|V.X.SIZE_MINMAX_VALUE|V.X.SIZE_SCALE_STOPS|V.X.SIZE_UNIT_VALUE,E=(L&(V.mf.FIELD_TARGETS_OUTLINE|V.mf.MINMAX_TARGETS_OUTLINE|V.mf.SCALE_TARGETS_OUTLINE|V.mf.UNIT_TARGETS_OUTLINE))>>>4;return i.isOutline||i.isOutlinedFill?v&E:v&~E}(i,v)&i;this.vvSizeMinMaxValue=!!(E&V.X.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(E&V.X.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(E&V.X.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(E&V.X.SIZE_SCALE_STOPS)}},c=L=>class extends L{get vvRotation(){return 0!==this.bit(15)}set vvRotation(i){this.setBit(15,i)}hasVV(){return super.hasVV()||this.vvRotation}setVV(i,v){super.setVV(i,v),this.vvRotation=!v.isOutline&&!!(i&V.X.ROTATION)}},l=L=>class extends L{get vvColor(){return 0!==this.bit(13)}set vvColor(i){this.setBit(13,i)}hasVV(){return super.hasVV()||this.vvColor}setVV(i,v){super.setVV(i,v),this.vvColor=!v.isOutline&&!!(i&V.X.COLOR)}},f=L=>class extends L{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(i){this.setBit(14,i)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(i,v){super.setVV(i,v),this.vvOpacity=!v.isOutline&&!!(i&V.X.OPACITY)}};class h extends(l(f(d(S)))){static load(i){const v=this.shared;return v.data=i,v}static from(i){const v=this.load(0);return v.geometryType=V.LW.FILL,v.dotDensity="dot-density"===i.stride.fill,v.simple="simple"===i.stride.fill,v.outlinedFill=i.isOutlinedFill,v.dotDensity||v.setVV(i.vvFlags,i),v.data}getVariation(){return se(ne({},super.getVariation()),{dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}get dotDensity(){return!!this.bit(15)}set dotDensity(i){this.setBit(15,i)}get simple(){return!!this.bit(22)}set simple(i){this.setBit(22,i)}get outlinedFill(){return!!this.bit(21)}set outlinedFill(i){this.setBit(21,i)}}h.shared=new h(0);class y extends(l(f(c(d(S))))){static load(i){const v=this.shared;return v.data=i,v}static from(i){const v=this.load(0);return v.geometryType=V.LW.MARKER,v.setVV(i.vvFlags,i),v.data}getVariation(){return se(ne({},super.getVariation()),{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}y.shared=new y(0);class b extends(l(f(d(S)))){static load(i){const v=this.shared;return v.data=i,v}static from(i){const v=this.load(0);return v.geometryType=V.LW.LINE,v.setVV(i.vvFlags,i),v.data}getVariation(){return se(ne({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}b.shared=new b(0);class g extends(l(f(c(d(S))))){static load(i){const v=this.shared;return v.data=i,v}static from(i){const v=this.load(0);return v.geometryType=V.LW.TEXT,v.setVV(i.vvFlags,i),v.data}getVariation(){return se(ne({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}g.shared=new g(0);class z extends(d(S)){static load(i){const v=this.shared;return v.data=i,v}static from(i){const v=this.load(0);return v.geometryType=V.LW.LABEL,v.setVV(i.vvFlags,i),v.mapAligned=(0,T.NS)(i.placement),v.data}getVariation(){return se(ne({},super.getVariation()),{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}z.shared=new z(0)},61517:(O,A,m)=>{m.r(A),m.d(A,{default:()=>d});var M=m(15861),T=m(17626),V=m(986),N=(m(26584),m(8314)),D=m(63290),U=m(62208),_=m(10699),J=(m(90912),m(85931),m(82255),m(76898)),Y=m(84682),K=m(65234),q=m(99666),X=m(55130),ee=m(246),H=m(1825),R=m(32940),P=m(32954),j=m(13112);class Q{constructor(l){this._remoteClient=l,this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null}destroy(){}fetchResource(l,f){var h=this;return(0,M.Z)(function*(){const y=h._resourceMap,b=y.get(l);if(b)return b;let g=h._inFlightResourceMap.get(l);if(g)return g;try{g=h._remoteClient.invoke("tileRenderer.fetchResource",{url:l},ne({},f)),h._inFlightResourceMap.set(l,g),g.then(z=>(h._inFlightResourceMap.delete(l),y.set(l,z),z))}catch(z){return(0,_.D_)(z)?null:{width:0,height:0}}return g})()}getResource(l){var f;return null!=(f=this._resourceMap.get(l))?f:null}}function re(c,l){return(!c.minScale||c.minScale>=l)&&(!c.maxScale||c.maxScale<=l)}function G(c){const l=c.message,f={message:{data:{},tileKey:l.tileKey,tileKeyOrigin:l.tileKeyOrigin},transferList:new Array};for(const h in l.data){const y=l.data[h];if(f.message.data[h]=null,(0,U.pC)(y)){const b=y.stride,g=y.indices.slice(0),z=y.vertices.slice(0),L=y.records.slice(0),i={stride:b,indices:g,vertices:z,records:L,metrics:(0,U.yw)(y.metrics,v=>v.slice(0))};f.transferList.push(g,z,L),f.message.data[h]=i}}return f}D.Z.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");let S=class extends j.Z{constructor(){super(...arguments),this.type="symbol",this._matchers={feature:null,aggregate:null},this._bufferData=new Map,this._bufferIds=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]),this._resourceManagerProxy=new Q(this.remoteClient)}destroy(){this._resourceManagerProxy.destroy()}get supportsTileUpdates(){return!0}forEachBufferId(c){this._bufferIds.forEach(l=>{l.forEach(c)})}update(c,l){var f=this;return(0,M.Z)(function*(){const h=l.schema.processors[0];if("symbol"!==h.type)return;const y=(0,Y.Hg)(f._schema,h);(0,Y.uD)(y,"mesh")&&((0,N.Z)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",y),c.mesh=!0,c.why.mesh.push("Symbology changed"),f._schema=h,f._factory=f._createFactory(h),f._factory.update(h,f.tileStore.tileScheme.tileInfo))})()}onTileMessage(c,l,f,h){return(0,_.k_)(h),this._onTileData(c,l,f,h)}onTileClear(c){return this._bufferData.delete(c.key.id),this._bufferIds.delete(c.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:c.id,data:{clear:!0}})}onTileError(c,l,f){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:c.id,error:l},{signal:f.signal})}onTileUpdate(c){for(const l of c.removed)this._bufferData.has(l.key.id)&&this._bufferData.delete(l.key.id),this._bufferIds.has(l.key.id)&&this._bufferIds.delete(l.key.id);for(const l of c.added)this._bufferData.forEach(f=>{for(const h of f)h.message.tileKey===l.id&&this._updateTileMesh("append",l,G(h),[],!1,!1,null)})}_addBufferData(c,l){this._bufferData.has(c)||this._bufferData.set(c,[]),this._bufferData.get(c).push(G(l))}_createFactory(c){const{geometryType:l,objectIdField:f,fields:h}=this.service,b={geometryType:l,fields:h,spatialReference:K.Z.fromJSON(this.spatialReference)},g=new H.Wr((i,v)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",i,v),this.tileStore.tileScheme.tileInfo),{matcher:z,aggregateMatcher:L}=c.mesh;return this._store=g,this._matchers.feature=(0,R.fL)(z,g,b,this._resourceManagerProxy),this._matchers.aggregate=(0,U.yw)(L,i=>(0,R.fL)(i,g,b,this._resourceManagerProxy)),new ee.j(l,f,g)}_onTileData(c,l,f,h){var y=this;return(0,M.Z)(function*(){(0,_.k_)(h);const{type:b,addOrUpdate:g,remove:z}=l,L=l.end,i=!!y._schema.mesh.sortKey;if(!g)return y.remoteClient.invoke("tileRenderer.onTileData",{tileKey:c.id,data:{type:b,addOrUpdate:null,remove:z,clear:!1,end:L,sort:i}},h);const v=y._processFeatures(c,g,f,h);try{const E=yield v;if((0,U.Wi)(E))return y.remoteClient.invoke("tileRenderer.onTileData",{tileKey:c.id,data:{type:b,addOrUpdate:null,remove:z,clear:!1,end:L,sort:i}},h);const e=[];for(const t of E){let r=!1;const n=t.message.bufferIds,s=c.key.id,o=t.message.tileKey;if(s!==o&&(0,U.pC)(n)){if(!y.tileStore.get(o)){y._addBufferData(s,t),e.push(t);continue}let u=y._bufferIds.get(o);u||(u=new Set,y._bufferIds.set(o,u));const p=Array.from(n);for(const I of p){if(u.has(I)){r=!0;break}u.add(I)}}r||(y._addBufferData(s,t),e.push(t))}yield(0,_.$6)(e.map(t=>{const r=c.key.id===t.message.tileKey;return y._updateTileMesh(b,c,t,r?l.remove:[],r&&l.end,l.clear,h.signal)}))}catch(E){y._handleError(c,E,h)}})()}_updateTileMesh(c,l,f,h,y,b,g){var z=this;return(0,M.Z)(function*(){const L=c,i=f.message.tileKey,v=!!z._schema.mesh.sortKey;i!==l.key.id&&(y=!1);const E=(0,U.yw)(f,n=>n.message),e=(0,U.yw)(f,n=>n.transferList)||[],t={type:L,addOrUpdate:E,remove:h,clear:!1,end:y,sort:v},r={transferList:(0,U.Wg)(e)||[],signal:g};return(0,_.k_)(r),z.remoteClient.invoke("tileRenderer.onTileData",{tileKey:i,data:t},r)})()}_processFeatures(c,l,f,h){var y=this;return(0,M.Z)(function*(){if((0,U.Wi)(l)||!l.hasFeatures)return null;const b={transform:c.transform,hasZ:!1,hasM:!1},g=y._factory,z={viewingMode:"",scale:c.scale},L=yield y._matchers.feature,i=yield y._matchers.aggregate;(0,_.k_)(h);const v=y._getLabelInfos(c,l);return yield g.analyze(l.getCursor(),y._resourceManagerProxy,L,i,b,z),(0,_.k_)(h),y._writeFeatureSet(c,l,b,v,g,f)})()}_writeFeatureSet(c,l,f,h,y,b){const g=l.getSize(),z=new X._(c.key.id,{features:g,records:g,metrics:0},this._schema.mesh.matcher.stride,b,!0),L={viewingMode:"",scale:c.scale},i=l.getCursor();for(;i.next();)try{const E=i.getDisplayId(),e=(0,U.pC)(h)?h.get(E):null;y.writeCursor(z,i,f,L,c.level,e,this._resourceManagerProxy)}catch(E){}return z.serialize(c.tileInfoView.tileInfo.isWrappable)}_handleError(c,l,f){if(!(0,_.D_)(l))return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:c.id,error:l.message},{signal:f.signal})}_getLabelingSchemaForScale(c){const l=this._schema.mesh.labels;if((0,U.Wi)(l))return null;if("subtype"===l.type){const h={type:"subtype",classes:{}};let y=!1;for(const b in l.classes){const g=l.classes[b].filter(z=>re(z,c.scale));y=y||!!g.length,h.classes[b]=g}return y?h:null}const f=l.classes.filter(h=>re(h,c.scale));return f.length?{type:"simple",classes:f}:null}_getLabels(c,l){if("subtype"===l.type){var f;const y=(0,U.s3)(this.service.subtypeField,"Expected to find subtype Field"),b=c.readAttribute(y);return null==b?[]:null!=(f=l.classes[b])?f:[]}return l.classes}_getLabelInfos(c,l){const f=this._getLabelingSchemaForScale(c);if((0,U.Wi)(f))return null;const h=new Map,y=l.getCursor();for(;y.next();){const b=y.getDisplayId(),g=[],z=(0,q.nE)(b),L=z&&1!==y.readAttribute("cluster_count")?"aggregate":"feature",i=this._getLabels(y,f);for(const v of i){if(v.target!==L)continue;const e=y.getStorage().getComputedStringAtIndex(z&&"feature"===L?y.readAttribute("referenceId"):b,v.fieldIndex);if(!e)continue;const t=(0,V.E)(e.toString()),n=t[1];this._store.getMosaicItem(v.symbol,(0,P._)(t[0])).then(s=>{g[v.index]={glyphs:s.glyphMosaicItems,rtl:n,index:v.index}})}h.set(b,g)}return h}};S=(0,T._)([(0,J.j)("esri.views.2d.layers.features.processors.SymbolProcessor")],S);const d=S},11263:(O,A,m)=>{m.d(A,{xS:()=>G,B3:()=>re});var M=m(15861),T=m(84175),V=m(39406),k=m(18716);const N={marker:V.LW.MARKER,fill:V.LW.FILL,line:V.LW.LINE,text:V.LW.TEXT};class D{constructor(d,c,l,f){const h={minScale:null==c?void 0:c.minScale,maxScale:null==c?void 0:c.maxScale},y=function U(S){return S.minScale||S.maxScale?S.minScale+"-"+S.maxScale:""}(h);this.layers=d,this.data=c,this.hash=this._createHash()+y,this.rendererKey=l;const b={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:l};for(const g of d)g.materialKey=(0,k.jj)(N[g.type],b),g.maxVVSize=f,g.scaleInfo=h,g.templateHash+=y}get type(){return"expanded-cim"}_createHash(){let d="";for(const c of this.layers)d+=c.templateHash;return d}}var _=m(83100),w=m(26584),x=m(10699),W=m(21726),J=m(84687),Y=m(29840),K=m(78241);function q(S,d,c){return X.apply(this,arguments)}function X(){return(X=(0,M.Z)(function*(S,d,c){if(!S.name)return Promise.reject(new w.Z("style-symbol-reference-name-missing","Missing name in style symbol reference"));if(S.styleName&&"Esri2DPointSymbolsStyle"===S.styleName)return ee(S,c);try{return R(yield(0,K.n2)(S,d,c),S.name,d,c)}catch(l){return(0,x.k_)(l),null}})).apply(this,arguments)}function ee(S,d){return H.apply(this,arguments)}function H(){return(H=(0,M.Z)(function*(S,d){const c=K.wm.replace(/\{SymbolName\}/gi,S.name);try{const l=yield(0,K.EJ)(c,d);return(0,K.KV)(l.data)}catch(l){return(0,x.k_)(l),null}})).apply(this,arguments)}function R(S,d,c,l){return P.apply(this,arguments)}function P(){return(P=(0,M.Z)(function*(S,d,c,l){const f=S.data,h={portal:c&&c.portal||J.Z.getDefault(),url:(0,W.mN)(S.baseUrl),origin:"portal-item"},y=f.items.find(g=>g.name===d);if(!y)throw new w.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${d}' could not be found`,{symbolName:d});let b=(0,Y.f)((0,K.v9)(y,"cimRef"),h);(0,_.XO)()&&(b=(0,_.pJ)(b));try{const g=yield(0,K.EJ)(b,l);return(0,K.KV)(g.data)}catch(g){return(0,x.k_)(g),null}})).apply(this,arguments)}const Q=function(){var S=(0,M.Z)(function*(d,c,l){return new D(yield(0,T.c)(d.data,c,l),d.data,d.rendererKey,d.maxVVSize)});return function(c,l,f){return S.apply(this,arguments)}}(),re=function(){var S=(0,M.Z)(function*(d,c,l,f){if(!d)return null;if("cim"===d.type)return Q(d,c,l);if("web-style"===d.type){const h={type:"cim",data:yield q(d,null,f),rendererKey:d.rendererKey,maxVVSize:d.maxVVSize};return Q(h,c,l)}return d});return function(c,l,f,h){return S.apply(this,arguments)}}();function G(S){if(!S)return null;const{type:d,cim:c,url:l,materialHash:f}=S,h={cim:c,type:d,mosaicHash:f,url:l,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(d){case"marker":h.size=S.size,h.path=S.path;break;case"line":h.dashTemplate=S.dashTemplate;break;case"text":h.text=S.text,h.fontName=S.fontName}return h}}}]);