"use strict";(self.webpackChunkesri4_pwa=self.webpackChunkesri4_pwa||[]).push([[8967],{53023:(H,w,i)=>{i.d(w,{hN:()=>J,P0:()=>B,cW:()=>E});var _=i(15861),C=i(26584),Z=i(33190),b=i(11519),p=i(91179),O=i(37053);function g(r,n){return r?n?4:3:n?3:2}function y(r,n,R,P,U){if(!r)return!1;const T=g(n,R),{coords:t,lengths:s}=r;let l=!1,u=0;for(const f of s)l=v(l,t,T,u,f,P,U),u+=f*T;return l}function v(r,n,R,P,U,T,t){let s=r,l=P;for(let u=P,f=P+U*R;u<f;u+=R){l=u+R,l===f&&(l=P);const M=n[u],I=n[u+1],h=n[l],W=n[l+1];(I<t&&W>=t||W<t&&I>=t)&&M+(t-I)/(W-I)*(h-M)<T&&(s=!s)}return s}var G=i(82054),j=i(88071),x=i(82959),N=i(6185);const A="feature-store:unsupported-query",L={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},K_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},K_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},K_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function D(r){return!0===K_spatialRelationship[r]}function e(r){return!0===K_queryGeometry[(0,p.Ji)(r)]}function o(r){return!0===K_layerGeometry[r]}function E(r,n,R,P,U){if((0,p.oU)(n)&&"esriGeometryPoint"===R&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r)){const T=(0,G.Uy)(new j.Z,n,!1,!1);return Promise.resolve(t=>function a(r,n,R,P){return y(r,n,R,P.coords[0],P.coords[1])}(T,!1,!1,t))}if((0,p.oU)(n)&&"esriGeometryMultipoint"===R){const T=(0,G.Uy)(new j.Z,n,!1,!1);if("esriSpatialRelContains"===r)return Promise.resolve(t=>function m(r,n,R,P,U,T){const t=g(U,T),{coords:s,lengths:l}=P;if(!l)return!1;for(let u=0,f=0;u<l.length;u++,f+=t)if(!y(r,n,R,s[f],s[f+1]))return!1;return!0}(T,!1,!1,t,P,U))}if((0,p.YX)(n)&&"esriGeometryPoint"===R&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r))return Promise.resolve(T=>(0,Z.aV)(n,(0,N.Op)(R,P,U,T)));if((0,p.YX)(n)&&"esriGeometryMultipoint"===R&&"esriSpatialRelContains"===r)return Promise.resolve(T=>(0,Z.lQ)(n,(0,N.Op)(R,P,U,T)));if((0,p.YX)(n)&&"esriSpatialRelIntersects"===r){const T=function V(r){return"mesh"===r?b.h_:(0,b.IY)(r)}(R);return Promise.resolve(t=>T(n,(0,N.Op)(R,P,U,t)))}return function S(){return Promise.all([i.e(4918),i.e(8592)]).then(i.bind(i,32825))}().then(T=>{const t=T[L[r]].bind(null,n.spatialReference,n);return s=>t((0,N.Op)(R,P,U,s))})}function B(r,n,R){return F.apply(this,arguments)}function F(){return(F=(0,_.Z)(function*(r,n,R){const{spatialRel:P,geometry:U}=r;if(U){if(!D(P))throw new C.Z(A,"Unsupported query spatial relationship",{query:r});if((0,O.JY)(U.spatialReference)&&(0,O.JY)(R)){if(!e(U))throw new C.Z(A,"Unsupported query geometry type",{query:r});if(!o(n))throw new C.Z(A,"Unsupported layer geometry type",{query:r});if(r.outSR)return(0,x._W)(r.geometry&&r.geometry.spatialReference,r.outSR)}}})).apply(this,arguments)}function J(r){if((0,p.YX)(r))return!0;if((0,p.oU)(r)){for(const n of r.rings)if(5!==n.length||n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1;return!0}return!1}},76530:(H,w,i)=>{function _(p,O){if(!p)return null;const g=O.featureAdapter,{startTimeField:a,endTimeField:m}=p;let y=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY;if(a&&m)O.forEach(G=>{const j=g.getAttribute(G,a),x=g.getAttribute(G,m);null==j||isNaN(j)||(y=Math.min(y,j)),null==x||isNaN(x)||(v=Math.max(v,x))});else{const G=a||m;O.forEach(j=>{const x=g.getAttribute(j,G);null==x||isNaN(x)||(y=Math.min(y,x),v=Math.max(v,x))})}return{start:y,end:v}}function C(p,O,g){if(!O||!p)return null;const{startTimeField:a,endTimeField:m}=p;if(!a&&!m)return null;const{start:y,end:v}=O;return null===y&&null===v?null:void 0===y&&void 0===v?()=>!1:a&&m?function Z(p,O,g,a,m){return null!=a&&null!=m?y=>{const v=p.getAttribute(y,O),G=p.getAttribute(y,g);return(null==v||v<=m)&&(null==G||G>=a)}:null!=a?y=>{const v=p.getAttribute(y,g);return null==v||v>=a}:null!=m?y=>{const v=p.getAttribute(y,O);return null==v||v<=m}:void 0}(g,a,m,y,v):function b(p,O,g,a){return null!=g&&null!=a&&g===a?m=>p.getAttribute(m,O)===g:null!=g&&null!=a?m=>{const y=p.getAttribute(m,O);return y>=g&&y<=a}:null!=g?m=>p.getAttribute(m,O)>=g:null!=a?m=>p.getAttribute(m,O)<=a:void 0}(g,a||m,y,v)}i.d(w,{R:()=>_,y:()=>C})},6185:(H,w,i)=>{i.d(w,{vF:()=>G,S2:()=>P,Op:()=>D,Up:()=>e,j6:()=>B,EG:()=>L});var _=i(15861),C=i(2076),Z=i(62208),b=i(16730),V=i(15176),p=i(91179),O=i(13924),g=i(37053),a=i(82054),m=i(88071),y=i(82959);const v=new C.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),G=Object.freeze({}),j=new m.Z,x=new m.Z,N=new m.Z,A={esriGeometryPoint:a.fQ,esriGeometryPolyline:a.J6,esriGeometryPolygon:a.eG,esriGeometryMultipoint:a.Iv};function L(t,s,l,u=t.hasZ,f=t.hasM){if((0,Z.Wi)(s))return null;const M=t.hasZ&&u,I=t.hasM&&f;if(l){const h=(0,a.Nh)(N,s,t.hasZ,t.hasM,"esriGeometryPoint",l,u,f);return(0,a.fQ)(h,M,I)}return(0,a.fQ)(s,M,I)}function D(t,s,l,u,f,M,I=s,h=l){const W=s&&I,Q=l&&h,Y=(0,Z.pC)(u)?"coords"in u?u:u.geometry:null;if((0,Z.Wi)(Y))return null;if(f){let z=(0,a.zj)(x,Y,s,l,t,f,I,h);return M&&(z=(0,a.Nh)(N,z,W,Q,t,M)),A[t](z,W,Q)}if(M){const z=(0,a.Nh)(N,Y,s,l,t,M,I,h);return A[t](z,W,Q)}return(0,a.hY)(j,Y,s,l,I,h),A[t](j,W,Q)}function e(t,s,l){return o.apply(this,arguments)}function o(){return(o=(0,_.Z)(function*(t,s,l){const{outFields:u,orderByFields:f,groupByFieldsForStatistics:M,outStatistics:I}=t;if(u)for(let h=0;h<u.length;h++)u[h]=u[h].trim();if(f)for(let h=0;h<f.length;h++)f[h]=f[h].trim();if(M)for(let h=0;h<M.length;h++)M[h]=M[h].trim();if(I)for(let h=0;h<I.length;h++)I[h].onStatisticField&&(I[h].onStatisticField=I[h].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),B(t,s,l)})).apply(this,arguments)}function B(t,s,l){return F.apply(this,arguments)}function F(){return(F=(0,_.Z)(function*(t,s,l){if(!t)return null;let{where:u}=t;if(t.where=u=u&&u.trim(),(!u||/^1 *= *1$/.test(u)||s&&s===u)&&(t.where=null),!t.geometry)return t;let f=yield J(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:W}=t.geometry;f=(0,V.aO)(f),f.spatialReference=W}t.geometry=f,yield(0,y._W)(f.spatialReference,l);const M=(yield(0,O.aX)((0,p.im)(f)))[0];if((0,Z.Wi)(M))throw G;const I=M.toJSON(),h=yield(0,y.iV)(I,I.spatialReference,l);if(!h)throw G;return h.spatialReference=l,t.geometry=h,t})).apply(this,arguments)}function J(t){return r.apply(this,arguments)}function r(){return(r=(0,_.Z)(function*(t){const{geometry:s,distance:l,units:u}=t;if(null==l||"vertexAttributes"in s)return s;const f=s.spatialReference,M=u?v.fromJSON(u):(0,b.qE)(f),I=f&&((0,g.sT)(f)||(0,g.sS)(f))?s:yield(0,y._W)(f,g.Zn).then(()=>(0,y.iV)(s,g.Zn));return(yield n())(I.spatialReference,I,l,M)})).apply(this,arguments)}function n(){return R.apply(this,arguments)}function R(){return(R=(0,_.Z)(function*(){return(yield Promise.all([i.e(4918),i.e(8592)]).then(i.bind(i,32825))).geodesicBuffer})).apply(this,arguments)}function P(t){return t&&U in t?JSON.parse(JSON.stringify(t,T)):t}const U="_geVersion",T=(t,s)=>t!==U?s:void 0},8967:(H,w,i)=>{i.r(w),i.d(w,{default:()=>K});var _=i(15861),C=i(26584),Z=i(63290),b=i(62208),V=i(65401),p=i(32442),O=i(53023),g=i(76530),a=i(6185),m=i(84952),y=i(55746);const v=Z.Z.getLogger("esri.views.2d.layers.features.support.whereUtils"),G={getAttribute:(D,e)=>D.field(e)};function x(){return(x=(0,_.Z)(function*(D,e){const o=yield i.e(410).then(i.bind(i,10410));try{const S=o.WhereClause.create(D,e);if(!S.isStandardized){const E=new C.Z("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",S);v.error(E)}return E=>{const B=E.readArcadeFeature();return S.testFeature(B,G)}}catch(S){return v.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",D),E=>!0}})).apply(this,arguments)}const N=Z.Z.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter");class K{constructor(e){this._geometryBounds=(0,V.Ue)(),this._idToVisibility=new Map,this._serviceInfo=e}get hash(){return this._hash}check(e){return this._applyFilter(e)}clear(){const e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}}invalidate(){this._idToVisibility.forEach((e,o)=>{this._idToVisibility.set(o,0)})}setKnownIds(e){for(const o of e)this._idToVisibility.set(o,1)}setTrue(e){const o=[],S=[],E=new Set(e);return this._idToVisibility.forEach((B,F)=>{const J=!!(1&this._idToVisibility.get(F)),r=E.has(F);!J&&r?o.push(F):J&&!r&&S.push(F),this._idToVisibility.set(F,r?3:0)}),{show:o,hide:S}}createQuery(){const{geometry:e,spatialRel:o,where:S,timeExtent:E,objectIds:B}=this;return m.Z.fromJSON({geometry:e,spatialRel:o,where:S,timeExtent:E,objectIds:B})}update(e,o){var S=this;return(0,_.Z)(function*(){S._hash=JSON.stringify(e);const E=yield(0,a.j6)(e,null,o);yield Promise.all([S._setGeometryFilter(E),S._setIdFilter(E),S._setAttributeFilter(E),S._setTimeFilter(E)])})()}_setAttributeFilter(e){var o=this;return(0,_.Z)(function*(){if(!e||!e.where)return o._clause=null,void(o.where=null);o._clause=yield function j(D,e){return x.apply(this,arguments)}(e.where,o._serviceInfo.fieldsIndex),o.where=e.where})()}_setIdFilter(e){this._idsToShow=e&&e.objectIds&&new Set(e.objectIds),this._idsToHide=e&&e.hiddenIds&&new Set(e.hiddenIds),this.objectIds=e&&e.objectIds}_setGeometryFilter(e){var o=this;return(0,_.Z)(function*(){if(!e||!e.geometry)return o._spatialQueryOperator=null,o.geometry=null,void(o.spatialRel=null);const S=e.geometry,E=e.spatialRel||"esriSpatialRelIntersects",B=yield(0,O.cW)(E,S,o._serviceInfo.geometryType,o._serviceInfo.hasZ,o._serviceInfo.hasM);(0,p.$P)(o._geometryBounds,S),o._spatialQueryOperator=B,o.geometry=S,o.spatialRel=E})()}_setTimeFilter(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=e.timeExtent,this._timeOperator=(0,g.y)(this._serviceInfo.timeInfo,e.timeExtent,y.k);else{const o=new C.Z("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);N.error(o)}}_applyFilter(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)}_filterByExpression(e){return!this.where||this._clause(e)}_filterById(e){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(e.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(e.getObjectId()))}_filterByGeometry(e){if(!this.geometry)return!0;const o=e.readHydratedGeometry();return!!o&&this._spatialQueryOperator(o)}_filterByTime(e){return!(0,b.pC)(this._timeOperator)||this._timeOperator(e)}_resetAllHiddenIds(){const e=[];return this._idToVisibility.forEach((o,S)=>{1&o||(this._idToVisibility.set(S,1),e.push(S))}),e}}}}]);