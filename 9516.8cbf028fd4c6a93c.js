"use strict";(self.webpackChunkesri4_pwa=self.webpackChunkesri4_pwa||[]).push([[9516],{90301:(D,E,e)=>{e.d(E,{eY:()=>R});var t=e(62208),v=e(30217),m=e(49966),u=e(9545),a=e(57477),r=e(14403),p=e(67969),c=e(55086);function d(l,o,i){const _={target:p.No.TEXTURE_2D,pixelFormat:p.VI.RGBA,internalFormat:p.VI.RGBA,dataType:p.Br.UNSIGNED_BYTE,wrapMode:p.e8.CLAMP_TO_EDGE};return o&&i&&(_.width=o,_.height=i),new c.x(l,_)}class R extends a.s{constructor(o=null,i,_=!0){super(),this.requestRenderOnSourceChangedEnabled=_,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=i,this.source=o,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(o){this._height=o}get source(){return this._source}set source(o){this._source=o,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(o){this._width=o}beforeRender(o){super.beforeRender(o),this.updateTexture(o.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:(0,m.c)()}}setTransform(o){const i=(0,v.b)(this.transforms.dvs),[_,y]=o.toScreenNoRotation([0,0],[this.x,this.y]),I=this.resolution/this.pixelRatio/o.resolution,x=I*this.width,C=I*this.height,T=Math.PI*this.rotation/180;(0,v.c)(i,i,(0,u.f)(_,y)),(0,v.c)(i,i,(0,u.f)(x/2,C/2)),(0,v.r)(i,i,-T),(0,v.c)(i,i,(0,u.f)(-x/2,-C/2)),(0,v.j)(i,i,(0,u.f)(x,C)),(0,v.m)(this.transforms.dvs,o.displayViewMat3,i)}setSamplingProfile(o){this._texture&&(o.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(o.samplingMode))}bind(o,i){this._texture&&o.bindTexture(this._texture,i)}updateTexture(o){var i;if(!this.stage)return null==(i=this._texture)||i.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this._texture=this.source?d(o,this.sourceWidth,this.sourceHeight):d(o));const _=this.source;if(_){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function s(l){return l&&"render"in l}(_))if(_ instanceof r.Z){const y=_.getRenderedRasterPixels();this._texture.setData((0,t.pC)(y)?y.renderedRasterPixels:null)}else this._texture.setData(function n(l){const o=document.createElement("canvas");return o.width=l.width,o.height=l.height,l.render(o.getContext("2d")),o}(_));else(function h(l){return l&&!("render"in l)})(_)&&this._texture.setData(_);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},71379:(D,E,e)=>{e.d(E,{s:()=>s});var t=e(65401),v=e(49966),m=e(90301),u=e(43783);class a extends u.I{constructor(n,d,R,l,o,i=null){super(n,d,R,l,o),this.bitmap=new m.eY(i,"standard",!1),this.bitmap.coordScale=[l,o],this.bitmap.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.bitmap.destroy()}beforeRender(n){super.beforeRender(n),this.bitmap.beforeRender(n)}afterRender(n){super.afterRender(n),this.bitmap.afterRender(n)}set stencilRef(n){this.bitmap.stencilRef=n}get stencilRef(){return this.bitmap.stencilRef}_createTransforms(){return{dvs:(0,v.c)(),tileMat3:(0,v.c)()}}setTransform(n,d){super.setTransform(n,d),this.bitmap.transforms.dvs=this.transforms.dvs}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap&&(this.bitmap.stage=null)}}var r=e(77598),p=e(39406),c=e(26268);class s extends c.Z{get requiresDedicatedFBO(){return this.children.some(n=>"additive"===n.bitmap.blendFunction)}createTile(n){const d=this._tileInfoView.getTileBounds((0,t.Ue)(),n),[R,l]=this._tileInfoView.tileInfo.size;return new a(n,d[0],d[3],R,l)}prepareRenderPasses(n){const d=n.registerRenderPass({name:"bitmap (tile)",brushes:[r.U.bitmap],target:()=>this.children.map(R=>R.bitmap),drawPhase:p.jx.MAP});return[...super.prepareRenderPasses(n),d]}doRender(n){this.visible&&n.drawPhase===p.jx.MAP&&super.doRender(n)}}},14403:(D,E,e)=>{e.d(E,{Z:()=>v});var t=e(62208);class v{constructor(u,a,r){this.pixelBlock=u,this.extent=a,this.originalPixelBlock=r}get width(){return(0,t.pC)(this.pixelBlock)?this.pixelBlock.width:0}get height(){return(0,t.pC)(this.pixelBlock)?this.pixelBlock.height:0}render(u){const a=this.pixelBlock;if((0,t.Wi)(a))return;const r=this.filter({pixelBlock:a});if((0,t.Wi)(r.pixelBlock))return;const p=r.pixelBlock.getAsRGBA(),c=u.createImageData(r.pixelBlock.width,r.pixelBlock.height);c.data.set(p),u.putImageData(c,0,0)}getRenderedRasterPixels(){const u=this.filter({pixelBlock:this.pixelBlock});return(0,t.Wi)(u.pixelBlock)?null:{width:u.pixelBlock.width,height:u.pixelBlock.height,renderedRasterPixels:new Uint8Array(u.pixelBlock.getAsRGBA().buffer)}}}},26268:(D,E,e)=>{e.d(E,{Z:()=>p});var t=e(8314),v=e(39406),m=e(44589),u=e(29384),a=e(13382);const r=(c,s)=>c.key.level-s.key.level!=0?c.key.level-s.key.level:c.key.row-s.key.row!=0?c.key.row-s.key.row:c.key.col-s.key.col;class p extends m.Z{constructor(s){super(),this._tileInfoView=s}get requiresDedicatedFBO(){return!1}renderChildren(s){this.sortChildren(r),this.setStencilReference(s),super.renderChildren(s)}createRenderParams(s){const{state:h}=s,n=super.createRenderParams(s);return n.requiredLevel=this._tileInfoView.getClosestInfoForScale(h.scale).level,n.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(h.scale),n}prepareRenderPasses(s){const h=super.prepareRenderPasses(s);return h.push(s.registerRenderPass({name:"stencil",brushes:[a.Z],drawPhase:v.jx.DEBUG|v.jx.MAP|v.jx.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,t.Z)("esri-tiles-debug")&&h.push(s.registerRenderPass({name:"tileInfo",brushes:[u.Z],drawPhase:v.jx.DEBUG,target:()=>this.children})),h}getStencilTarget(){return this.children}updateTransforms(s){for(const h of this.children){const n=this._tileInfoView.getTileResolution(h.key);h.setTransform(s,n)}}setStencilReference(s){let h=1;for(const n of this.children)n.stencilRef=h++}}},43783:(D,E,e)=>{e.d(E,{I:()=>u});var t=e(30217),v=e(57477),m=e(58098);class u extends v.s{constructor(r,p,c,s,h,n=s,d=h){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new m.Z(r),this.x=p,this.y=c,this.width=s,this.height=h,this.rangeX=n,this.rangeY=d}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(r,p){const c=p/(r.resolution*r.pixelRatio),s=this.transforms.tileMat3,[h,n]=r.toScreenNoRotation([0,0],[this.x,this.y]);(0,t.s)(s,this.width/this.rangeX*c,0,0,0,this.height/this.rangeY*c,0,h,n,1),(0,t.m)(this.transforms.dvs,r.displayViewMat3,s)}}},91082:(D,E,e)=>{e.d(E,{Y:()=>s});var t=e(17626),p=(e(63290),e(90912),e(85931),e(8314),e(82255),e(76898)),c=e(71379);const s=h=>{let n=class extends h{attach(){this.view.timeline.record(`${this.layer.title} (BitmapTileLayer) Attach`),this._bitmapView=new c.s(this._tileInfoView),this.container.addChild(this._bitmapView)}detach(){var d;this.container.removeChild(this._bitmapView),null==(d=this._bitmapView)||d.removeAllChildren()}};return n=(0,t._)([(0,p.j)("esri.views.2d.layers.BitmapTileLayerView2D")],n),n}},37384:(D,E,e)=>{e.d(E,{y:()=>Z});var t=e(17626),v=e(48701),m=e(89726),u=e(26584),a=e(32917),r=e(77712),h=(e(85931),e(8314),e(90912),e(76898)),n=e(1011),d=e(86810);e(63290),e(82255);let o=class extends d.wq{};o=(0,t._)([(0,h.j)("esri.views.layers.support.ClipArea")],o);const i=o;var _;let y=_=class extends i{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new _({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"left",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"right",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"top",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"bottom",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],y.prototype,"version",null),y=_=(0,t._)([(0,h.j)("esri.views.layers.support.ClipRect")],y);const I=y;e(29132);var j,C=e(21674),T=e(91179),A=e(2004),W=e(37118);const S={base:C.Z,key:"type",typeMap:{extent:A.Z,polygon:W.Z}};let B=j=class extends i{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new j({geometry:this.geometry.clone()})}};(0,t._)([(0,r.Cb)({types:S,json:{read:T.im,write:!0}})],B.prototype,"geometry",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],B.prototype,"version",null),B=j=(0,t._)([(0,h.j)("esri.views.layers.support.Geometry")],B);const K=B;let L=class extends i{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};(0,t._)([(0,r.Cb)({type:[[[Number]]],json:{write:!0}})],L.prototype,"path",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],L.prototype,"version",null),L=(0,t._)([(0,h.j)("esri.views.layers.support.Path")],L);const U=v.Z.ofType({key:"type",base:i,typeMap:{rect:I,path:L,geometry:K}}),Z=H=>{let P=class extends H{constructor(){super(...arguments),this.attached=!1,this.clips=new U,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1}initialize(){var g,f,O,b;const G=null==(g=null==(f=this.view)?void 0:f.spatialReferenceLocked)||g;(null==(O=this.view)?void 0:O.spatialReference)&&G&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new u.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new n.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,a.YP)(()=>this.suspended,M=>{this.container&&(this.container.visible=!M),this.view&&!M&&this.updateRequested&&this.view.requestUpdate()},a.tX),(0,a.YP)(()=>{var M,w;return null!=(M=null==(w=this.layer)?void 0:w.opacity)?M:1},M=>{this.container&&(this.container.opacity=M)},a.tX),(0,a.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",M=>{this.container&&(this.container.blendMode=M)},a.tX),(0,a.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,M=>{this.container&&(this.container.effect=M)},a.tX),(0,a.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)})]),null!=(b=this.view)&&b.whenLayerView?this.view.whenLayerView(this.layer).then(M=>{M===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){var g;const f=null==(g=this.view)?void 0:g.spatialReference;return null==f||this.supportsSpatialReference(f)}get updating(){var g;return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(null==(g=this.updatingHandles)||!g.updating))}get visibleAtCurrentScale(){return this.isVisibleAtScale(this.view.scale)}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.detach(),this.updateRequested=!1)}isVisibleAtScale(g){const f=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!f)return!0;const{minScale:O,maxScale:b}=f;return(0===O||g<=O)&&(0===b||g>=b)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(g){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",g),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(g))):this.updateRequested=!1}hitTest(g,f){return Promise.resolve(null)}supportsSpatialReference(g){return!0}isUpdating(){return!1}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const g=super.getSuspendInfo(),f=!this.spatialReferenceSupported,O=this.visibleAtCurrentScale;return f&&(g.spatialReferenceNotSupported=f),O&&(g.outsideScaleRange=O),g}};return(0,t._)([(0,r.Cb)()],P.prototype,"attached",void 0),(0,t._)([(0,r.Cb)({type:U,set(g){const f=(0,m.Z)(g,this._get("clips"),U);this._set("clips",f)}})],P.prototype,"clips",void 0),(0,t._)([(0,r.Cb)()],P.prototype,"container",void 0),(0,t._)([(0,r.Cb)()],P.prototype,"moving",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],P.prototype,"spatialReferenceSupported",null),(0,t._)([(0,r.Cb)({readOnly:!0})],P.prototype,"updateParameters",void 0),(0,t._)([(0,r.Cb)()],P.prototype,"updateRequested",void 0),(0,t._)([(0,r.Cb)()],P.prototype,"updating",null),(0,t._)([(0,r.Cb)()],P.prototype,"view",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],P.prototype,"visibleAtCurrentScale",null),P=(0,t._)([(0,h.j)("esri.views.2d.layers.LayerView2D")],P),P}},88893:(D,E,e)=>{function m(a,r,p,c){if(p.level===c.level)return r;const s=a.tileInfo.size,h=a.getTileResolution(p.level),n=a.getTileResolution(c.level);let d=a.getLODInfoAt(c.level);const R=d.getXForColumn(c.col),l=d.getYForRow(c.row);d=a.getLODInfoAt(p.level);const o=d.getXForColumn(p.col),i=d.getYForRow(p.row),_=function t(a){return a instanceof HTMLImageElement?a.naturalWidth:a.width}(r)/s[0],y=function v(a){return a instanceof HTMLImageElement?a.naturalHeight:a.height}(r)/s[1],I=Math.round(_*((R-o)/h)),x=Math.round(y*(-(l-i)/h)),C=Math.round(_*s[0]*(n/h)),T=Math.round(y*s[1]*(n/h)),A=u(s);return A.getContext("2d").drawImage(r,I,x,C,T,0,0,s[0],s[1]),A}function u(a){const r=document.createElement("canvas");return[r.width,r.height]=a,r}e.d(E,{V:()=>u,i:()=>m})},45611:(D,E,e)=>{e.d(E,{Z:()=>o});var t=e(17626),v=e(14517),m=e(61885),u=e(80542),a=e(61996),r=e(63290),p=e(62208),c=e(60330),s=e(77712),R=(e(85931),e(8314),e(90912),e(76898));let l=class extends((0,u.p)((0,a.I)((0,c.v)(m.Z.EventedMixin(v.Z))))){constructor(i){super(i),this.layer=null,this.parent=null}initialize(){this.when().catch(i=>{if("layerview:create-error"!==i.name){const _=this.layer&&this.layer.id||"no id",y=this.layer&&this.layer.title||"no title";throw r.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${y}', id: '${_}')`,i),i}})}get fullOpacity(){return(0,p.Pt)(this.get("layer.opacity"),1)*(0,p.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){var i;return!!(null!=(i=this.updatingHandles)&&i.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var i;return!0===(null==(i=this.layer)?void 0:i.visible)}set visible(i){void 0!==i?this._override("visible",i):this._clearOverride("visible")}canResume(){var i,_,y;return this.visible&&(null==(i=this.layer)?void 0:i.loaded)&&!(null!=(_=this.parent)&&_.suspended)&&(null==(y=this.view)?void 0:y.ready)||!1}getSuspendInfo(){const i=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(i.viewNotReady=!0),this.layer&&this.layer.loaded||(i.layerNotLoaded=!0),this.visible||(i.layerInvisible=!0),i}isUpdating(){return!1}};(0,t._)([(0,s.Cb)()],l.prototype,"fullOpacity",null),(0,t._)([(0,s.Cb)()],l.prototype,"layer",void 0),(0,t._)([(0,s.Cb)()],l.prototype,"parent",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],l.prototype,"suspended",null),(0,t._)([(0,s.Cb)({readOnly:!0})],l.prototype,"suspendInfo",null),(0,t._)([(0,s.Cb)({readOnly:!0})],l.prototype,"legendEnabled",null),(0,t._)([(0,s.Cb)({type:Boolean,readOnly:!0})],l.prototype,"updating",null),(0,t._)([(0,s.Cb)({readOnly:!0})],l.prototype,"updatingProgress",null),(0,t._)([(0,s.Cb)()],l.prototype,"visible",null),(0,t._)([(0,s.Cb)()],l.prototype,"view",void 0),l=(0,t._)([(0,R.j)("esri.views.layers.LayerView")],l);const o=l},94421:(D,E,e)=>{e.d(E,{y:()=>h});var t=e(17626),v=e(63290),m=e(10699),u=e(32917),a=e(77712),s=(e(85931),e(8314),e(90912),e(76898));const h=n=>{let d=class extends n{initialize(){this.handles.add((0,u.on)(()=>this.layer,"refresh",R=>{this.doRefresh(R.dataChanged).catch(l=>{(0,m.D_)(l)||v.Z.getLogger(this.declaredClass).error(l)})}),"RefreshableLayerView")}};return(0,t._)([(0,a.Cb)()],d.prototype,"layer",void 0),d=(0,t._)([(0,s.j)("esri.layers.mixins.RefreshableLayerView")],d),d}}}]);