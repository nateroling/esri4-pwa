"use strict";var C=Object.defineProperty,g=Object.defineProperties,L=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,h=(a,s,t)=>s in a?C(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,E=(a,s)=>{for(var t in s||(s={}))T.call(s,t)&&h(a,t,s[t]);if(y)for(var t of y(s))U.call(s,t)&&h(a,t,s[t]);return a},O=(a,s)=>g(a,L(s));(self.webpackChunkesri4_pwa=self.webpackChunkesri4_pwa||[]).push([[9051],{39051:(a,s,t)=>{t.r(s),t.d(s,{default:()=>R});var v=t(15861),_=t(17626),p=t(26584),l=t(62208),d=t(77712),m=(t(85931),t(8314),t(90912),t(76898)),D=t(17253),f=t(68915),P=t(43930);function u(e,r){if((0,l.Wi)(e)&&(0,l.Wi)(r))return null;const n={};return(0,l.pC)(r)&&(n.geometry=r.toJSON()),(0,l.pC)(e)&&(n.where=e),n}let i=class extends f.default{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus="disconnected"}initialize(){this.handles.add([this.layer.watch("purgeOptions",()=>this._update()),this.watch("suspended",e=>{e?this._proxy.pauseStream():this._proxy.resumeStream()})])}get connectionError(){if(this.errorString)return new p.Z("stream-controller",this.errorString)}on(e,r){"data-received"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));const n=super.on(e,r),o=this;return{remove(){n.remove(),"data-received"===e&&(o._proxy.closed||o.hasEventListener("data-received")||o._proxy.enableEvent("data-received",!1))}}}queryLatestObservations(e,r){if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new p.Z("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then(n=>{const o=D.default.fromJSON(n);return o.features.forEach(c=>{c.layer=this.layer,c.sourceLayer=this.layer}),o})}detach(){super.detach(),this.connectionStatus="disconnected"}_createClientOptions(){return O(E({},super._createClientOptions()),{setProperty:e=>{this.set(e.propertyName,e.value)}})}_createTileRendererHash(e){const r=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(u(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+r}_createServiceOptions(){var e=this;return(0,v.Z)(function*(){const r=e.layer,{objectIdField:n}=r,o=r.fields.map(S=>S.toJSON()),c=(0,P.oq)(r.geometryType),I=r.timeInfo&&r.timeInfo.toJSON()||null,M=r.spatialReference?r.spatialReference.toJSON():null;return{type:"stream",fields:o,geometryType:c,objectIdField:n,timeInfo:I,source:e.layer.parsedUrl,serviceFilter:u(e.layer.definitionExpression,e.layer.geometryDefinition),purgeOptions:e.layer.purgeOptions.toJSON(),enableDataReceived:e._enabledDataReceived,spatialReference:M,maxReconnectionAttempts:e.layer.maxReconnectionAttempts,maxReconnectionInterval:e.layer.maxReconnectionInterval,updateInterval:e.layer.updateInterval,customParameters:r.customParameters}})()}};(0,_._)([(0,d.Cb)()],i.prototype,"errorString",void 0),(0,_._)([(0,d.Cb)({readOnly:!0})],i.prototype,"connectionError",null),(0,_._)([(0,d.Cb)()],i.prototype,"connectionStatus",void 0),i=(0,_._)([(0,m.j)("esri.views.2d.layers.StreamLayerView2D")],i);const R=i}}]);