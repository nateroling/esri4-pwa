"use strict";(self.webpackChunkesri4_pwa=self.webpackChunkesri4_pwa||[]).push([[6926],{80355:(wt,it,B)=>{B.d(it,{xQ:()=>Y,KC:()=>$,QI:()=>st,wF:()=>x,K:()=>g,Yx:()=>J,nb:()=>l,BH:()=>lt,NL:()=>K,Tg:()=>H});var Q=B(2076),et=B(62208),Z=B(60295),X=B(77692);const S=new Map;S.set("meter-per-second",1),S.set("kilometer-per-hour",.277778),S.set("knots",.514444),S.set("feet-per-second",.3048),S.set("mile-per-hour",.44704);const z=180/Math.PI,K=new Q.X({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function J(t,n){return S.get(t)/S.get(n)||1}function nt(t){return(450-t)%360}function H(t,n="geographic"){const[e,r]=t,a=Math.sqrt(e*e+r*r);let o=Math.atan2(r,e)*z;return o=(360+o)%360,"geographic"===n&&(o=nt(o)),[a,o]}function rt(t,n="geographic"){let e=t[1];"geographic"===n&&(e=nt(e)),e%=360;const r=t[0];return[r*Math.cos(e/z),r*Math.sin(e/z)]}function Y(t,n,e,r="geographic"){if(!(0,X.nk)(t)||(0,et.Wi)(e))return t;const a="vector-magdir"===n?t.clone():(0,et.Wg)($(t,n)),o=a.pixels[1];for(let c=0;c<o.length;c++)o[c]="geographic"===r?(o[c]+e[c]+270)%360:(o[c]+360-e[c])%360;return"vector-magdir"===n?a:$(a,"vector-magdir")}function $(t,n,e="geographic",r=1){if(!(0,X.nk)(t))return t;const{pixels:a,width:o,height:c}=t,M=o*c,w=a[0],i=a[1],u=t.pixelType.startsWith("f")?t.pixelType:"f32",s=Z.Z.createEmptyBand(u,M),p=Z.Z.createEmptyBand(u,M);let h=0;for(let v=0;v<c;v++)for(let A=0;A<o;A++)"vector-uv"===n?([s[h],p[h]]=H([w[h],i[h]],e),s[h]*=r):([s[h],p[h]]=rt([w[h],i[h]],e),s[h]*=r,p[h]*=r),h++;const f=new Z.Z({pixelType:u,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:[s,p]});return f.updateStatistics(),f}function st(t,n,e=1){if(1===e||!(0,X.nk)(t))return t;const r=t.clone(),{pixels:a,width:o,height:c}=r,M=a[0],w=a[1];let i=0;for(let u=0;u<c;u++)for(let s=0;s<o;s++)"vector-uv"===n?(M[i]*=e,w[i]*=e):M[i]*=e,i++;return r.updateStatistics(),r}function lt(t,n,e,r,a){if(!(0,et.pC)(a)||!a.spatialReference.equals(t.spatialReference))return{extent:t,width:Math.round(n/r),height:Math.round(e/r),resolution:t.width/n};const o=a.xmin,c=a.ymax,M=(t.xmax-t.xmin)/n*r,w=(t.ymax-t.ymin)/e*r,i=(M+w)/2;return t.xmin=o+Math.floor((t.xmin-o)/M)*M,t.xmax=o+Math.ceil((t.xmax-o)/M)*M,t.ymin=c+Math.floor((t.ymin-c)/w)*w,t.ymax=c+Math.ceil((t.ymax-c)/w)*w,{extent:t,width:Math.round(t.width/M),height:Math.round(t.height/w),resolution:i}}const q=function ht(t=0,n=0,e=Math.PI,r=!0){r&&(e=(2*Math.PI-e)%(2*Math.PI));const a=r?-1:1,o=13*a,c=-7*a,M=-2*a,w=-16*a,i=21.75,[u,s]=C(0,n+o,e,i),[p,h]=C(t-5.5,n+c,e,i),[f,v]=C(t+5.5,n+c,e,i),[A,I]=C(t-1.5,n+M,e,i),[T,P]=C(t+1.5,n+M,e,i),[O,k]=C(t-1.5,n+w,e,i),[E,L]=C(t+1.5,n+w,e,i);return[u,s,p,h,A,I,T,P,f,v,O,k,E,L]}(0,0,0);function ct(t=0,n=Math.PI,e=!0){e&&(n=(2*Math.PI-n)%(2*Math.PI));const a=e?-1:1,o=5*a,c=20*a,M=25*a,w=45,h=2*a;let[f,v]=[5,0-c],[A,I]=[f+2,v],[T,P]=[A-0,I+h],[O,k]=[-5,0-M],[E,L]=[O+0,k-h],b=Math.ceil(t/5),D=Math.floor(b/10);b-=8*D;const U=[],F=[];for(let dt=0;dt<b/2;dt++,D--){D<=0&&b%2==1&&dt===(b-1)/2&&(O=0,E=O+0,k=(k+v)/2,L=k-h);const[Mt,xt]=C(O,k,n,w);if(D>0){const[pt,_t]=C(A,k,n,w),[mt,gt]=C(f,v,n,w);U.push(pt),U.push(_t),U.push(Mt),U.push(xt),U.push(mt),U.push(gt)}else{const[pt,_t]=C(A,I,n,w),[mt,gt]=C(T,P,n,w),[Dt,vt]=C(E,L,n,w);F.push(Mt),F.push(xt),F.push(Dt),F.push(vt),F.push(mt),F.push(gt),F.push(pt),F.push(_t)}k+=o,v+=o,I+=o,P+=o,L+=o}const[j,V]=C(5,0+c,n,w),[at,ut]=C(7,0+c,n,w),[ft,yt]=C(5,0-M,n,w),[Pt,Et]=C(7,0-M,n,w);return{pennants:U,barbs:F,shaft:[j,V,at,ut,ft,yt,Pt,Et]}}function C(t,n,e,r=1){const a=Math.sqrt(t*t+n*n)/r,o=(2*Math.PI+Math.atan2(n,t))%(2*Math.PI);return[a,(2*Math.PI+o-e)%(2*Math.PI)]}const G=[0,1,3,6,10,16,21,27,33,40,47,55,63],tt=[0,.5,1,1.5,2],ot=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function R(t,n,e,r){const a=J(r||"knots",e);let o;for(o=1;o<n.length;o++)if(o===n.length-1){if(t<n[o]*a)break}else if(t<=n[o]*a)break;return Math.min(o-1,n.length-2)}function _(t,n,e,r,a){let o=0;switch(n){case"beaufort_kn":o=R(t,G,"knots",e);break;case"beaufort_km":o=R(t,G,"kilometer-per-hour",e);break;case"beaufort_ft":o=R(t,G,"feet-per-second",e);break;case"beaufort_m":o=R(t,G,"meter-per-second",e);break;case"classified_arrow":o=R(t,a,r,e);break;case"ocean_current_m":o=R(t,tt,"meter-per-second",e);break;case"ocean_current_kn":o=R(t,ot,"knots",e)}return o}const m=[];function g(t,n){let r=0,a=0;const{width:o,height:c,mask:M}=t,w=t.pixels[0],i=[],u=[],s=J(K.fromJSON(n.inputUnit),"knots"),p="wind_speed"===n.style?5:Number.MAX_VALUE;for(let h=0;h<c;h++)for(let f=0;f<o;f++){const v=w[h*o+f]*s;if((!M||M[h*o+f])&&v<p){for(let I=0;I<4;I++)i[r++]=(f+.5)/o,i[r++]=(h+.5)/c,i[r++]=I<2?-.5:.5,i[r++]=I%2==0?-.5:.5,i[r++]=0,i[r++]=v;const A=4*(r/24-1);u[a++]=A,u[a++]=A+1,u[a++]=A+2,u[a++]=A+1,u[a++]=A+2,u[a++]=A+3}}return{vertexData:new Float32Array(i),indexData:new Uint32Array(u)}}function x(t,n){return"simple_scalar"===n.style?g(t,n):"wind_speed"===n.style?function y(t,n){if(0===m.length)for(let f=0;f<30;f++)m.push(ct(5*f,0));const e=J(K.fromJSON(n.inputUnit),"knots"),{width:r,height:a,mask:o}=t,c=t.pixels[0],M=t.pixels[1],i=[],u=[];let s=0,p=0;for(let f=0;f<a;f++)for(let v=0;v<r;v++){const A=f*r+v,I=c[A]*e;if((!o||o[f*r+v])&&I>=5){var h;const T=null!=(h=(M[A]+360)%360/180*Math.PI)?h:2*Math.PI*Math.random(),{pennants:P,barbs:O,shaft:k}=m[Math.min(Math.floor(I/5),29)];if(P.length+O.length===0)continue;let E=i.length/6;const L=(v+.5)/r,b=(f+.5)/a;for(let D=0;D<P.length;D+=2)i[s++]=L,i[s++]=b,i[s++]=P[D],i[s++]=P[D+1]+T,i[s++]=0,i[s++]=I;for(let D=0;D<O.length;D+=2)i[s++]=L,i[s++]=b,i[s++]=O[D],i[s++]=O[D+1]+T,i[s++]=0,i[s++]=I;for(let D=0;D<k.length;D+=2)i[s++]=L,i[s++]=b,i[s++]=k[D],i[s++]=k[D+1]+T,i[s++]=0,i[s++]=I;for(let D=0;D<P.length/6;D++)u[p++]=E,u[p++]=E+1,u[p++]=E+2,E+=3;for(let D=0;D<O.length/8;D++)u[p++]=E,u[p++]=E+1,u[p++]=E+2,u[p++]=E+1,u[p++]=E+2,u[p++]=E+3,E+=4;u[p++]=E+0,u[p++]=E+1,u[p++]=E+2,u[p++]=E+1,u[p++]=E+3,u[p++]=E+2,E+=4}}return{vertexData:new Float32Array(i),indexData:new Uint32Array(u)}}(t,n):function d(t,n){const{style:e,inputUnit:r,outputUnit:a,breakValues:o}=n,c=K.fromJSON(r),M=K.fromJSON(a);let u=0,s=0;const{width:p,height:h,mask:f}=t,v=t.pixels[0],A=t.pixels[1],I=f?f.filter(k=>k>0).length:p*h,T=new Float32Array(42*I),P=new Uint32Array(15*I);for(let k=0;k<h;k++)for(let E=0;E<p;E++){const L=k*p+E;if(!f||f[k*p+E]){var O;const b=null!=(O=(A[L]+360)%360/180*Math.PI)?O:2*Math.PI*Math.random(),D=_(v[L],e,c,M,o);for(let F=0;F<q.length;F+=2)T[u++]=(E+.5)/p,T[u++]=(k+.5)/h,T[u++]=q[F],T[u++]=q[F+1]+b,T[u++]=D,T[u++]=v[L];const U=7*(u/42-1);P[s++]=U,P[s++]=U+1,P[s++]=U+2,P[s++]=U+0,P[s++]=U+4,P[s++]=U+3,P[s++]=U+0,P[s++]=U+2,P[s++]=U+3,P[s++]=U+2,P[s++]=U+5,P[s++]=U+3,P[s++]=U+5,P[s++]=U+6,P[s++]=U+3}}return{vertexData:T,indexData:P}}(t,n)}function l(t,n,e,r=[0,0],a=.5){const{width:o,height:c,mask:M}=t,[w,i]=t.pixels,[u,s]=r,p=Math.round((o-u)/e),h=Math.round((c-s)/e),f=p*h,v=new Float32Array(f),A=new Float32Array(f),I=new Uint8Array(f),T="vector-uv"===n;for(let O=0;O<h;O++)for(let k=0;k<p;k++){let E=0;const L=O*p+k,b=Math.max(0,O*e+s),D=Math.max(0,k*e+u),U=Math.min(c,b+e),F=Math.min(o,D+e);for(let j=b;j<U;j++)for(let V=D;V<F;V++){const W=j*o+V;if(!M||M[W]){E++;const at=T?[w[W],i[W]]:[w[W],(360+i[W])%360],[ut,ft]=T?at:rt(at);v[L]+=ut,A[L]+=ft}}if(E>=(U-b)*(F-D)*(1-a)){I[L]=1;const[j,V]=H([v[L]/E,A[L]/E]);v[L]=j,A[L]=V}else I[L]=0,v[L]=0,A[L]=0}const P=new Z.Z({width:p,height:h,pixels:[v,A],mask:I});return P.updateStatistics(),P}},37084:(wt,it,B)=>{B.d(it,{z_:()=>rt,KK:()=>G});var Q=B(15861),Z=(B(29132),B(63290)),X=B(21286),S=B(62208),z=B(10699),N=B(4619),K=B(37053),J=B(2004);const nt=Z.Z.getLogger("esri.views.2d.engine.flow.dataUtils");function rt(_,d,m){return Y.apply(this,arguments)}function Y(){return(Y=(0,Q.Z)(function*(_,d,m){const y=performance.now(),g=$(_,d),x=performance.now(),l=lt(_,g,d.width,d.height),t=performance.now(),n=ht(l,!0),e=performance.now(),r=ct(n),a=performance.now();if(_.profile){const o={"_createFlowFieldFromData()":Math.round(x-y),"_getStreamlines()":Math.round(t-x),"createAnimatedLinesData()":Math.round(e-t),"createLinesMesh()":Math.round(a-e),"Total elapsed time":Math.round(a-y)};nt.info("createStreamlinesMesh profile",o)}return yield Promise.resolve(),(0,z.k_)(m),r})).apply(this,arguments)}function $(_,d){const m=function q(_,d,m,y){if(0===y)return _;const g=Math.round(3*y),x=new Array(2*g+1);let l=0;for(let e=-g;e<=g;e++){const r=Math.exp(-e*e/(y*y));x[e+g]=r,l+=r}for(let e=-g;e<=g;e++)x[e+g]/=l;const t=new Float32Array(_.length);for(let e=0;e<m;e++)for(let r=0;r<d;r++){let a=0,o=0;for(let c=-g;c<=g;c++){if(r+c<0||r+c>=d)continue;const M=x[c+g];a+=M*_[2*(e*d+(r+c))+0],o+=M*_[2*(e*d+(r+c))+1]}t[2*(e*d+r)+0]=a,t[2*(e*d+r)+1]=o}const n=new Float32Array(_.length);for(let e=0;e<d;e++)for(let r=0;r<m;r++){let a=0,o=0;for(let c=-g;c<=g;c++){if(r+c<0||r+c>=m)continue;const M=x[c+g];a+=M*t[2*((r+c)*d+e)+0],o+=M*t[2*((r+c)*d+e)+1]}n[2*(r*d+e)+0]=a,n[2*(r*d+e)+1]=o}return n}(d.data,d.width,d.height,_.smoothing);return _.interpolate?(y,g)=>{const x=Math.floor(y),l=Math.floor(g);if(x<0||x>=d.width)return[0,0];if(l<0||l>=d.height)return[0,0];const t=y-x,n=g-l,a=x<d.width-1?x+1:x,o=l<d.height-1?l+1:l;return[(m[2*(l*d.width+x)]*(1-n)+m[2*(o*d.width+x)]*n)*(1-t)+(m[2*(l*d.width+a)]*(1-n)+m[2*(o*d.width+a)]*n)*t,(m[2*(l*d.width+x)+1]*(1-n)+m[2*(o*d.width+x)+1]*n)*(1-t)+(m[2*(l*d.width+a)+1]*(1-n)+m[2*(o*d.width+a)+1]*n)*t]}:(y,g)=>{const x=Math.round(y),l=Math.round(g);return x<0||x>=d.width||l<0||l>=d.height?[0,0]:[m[2*(l*d.width+x)+0],m[2*(l*d.width+x)+1]]}}function st(_,d,m,y,g,x,l,t,n){const e=[];let r=m,a=y,o=0,[c,M]=d(r,a);c*=_.velocityScale,M*=_.velocityScale;const w=Math.sqrt(c*c+M*M);let i,u;e.push({x:r,y:a,t:o,speed:w});for(let s=0;s<_.verticesPerLine;s++){let[p,h]=d(r,a);p*=_.velocityScale,h*=_.velocityScale;const f=Math.sqrt(p*p+h*h);if(f<_.minSpeedThreshold)return e;const v=p/f,A=h/f;if(r+=v*_.segmentLength,a+=A*_.segmentLength,o+=_.segmentLength/f,Math.acos(v*i+A*u)>_.maxTurnAngle)return e;if(_.mergeLines){const I=Math.round(r*n),T=Math.round(a*n);if(I<0||I>l-1||T<0||T>t-1)return e;const P=x[T*l+I];if(-1!==P&&P!==g)return e;x[T*l+I]=g}e.push({x:r,y:a,t:o,speed:f}),i=v,u=A}return e}function lt(_,d,m,y){const g=[],x=new N.Z,l=1/Math.max(_.lineCollisionWidth,1),t=Math.round(m*l),n=Math.round(y*l),e=new Int32Array(t*n);for(let a=0;a<e.length;a++)e[a]=-1;const r=[];for(let a=0;a<y;a+=_.lineSpacing)for(let o=0;o<m;o+=_.lineSpacing)r.push({x:o,y:a,sort:x.getFloat()});r.sort((a,o)=>a.sort-o.sort);for(const{x:a,y:o}of r)if(x.getFloat()<_.density){const c=st(_,d,a,o,g.length,e,t,n,l);if(c.length<2)continue;g.push(c)}return g}function ht(_,d){const m=new N.Z,y=_.reduce((n,e)=>n+e.length,0),g=new Float32Array(4*y),x=new Array(_.length);let l=0,t=0;for(const n of _){const e=l;for(const r of n)g[4*l+0]=r.x,g[4*l+1]=r.y,g[4*l+2]=r.t,g[4*l+3]=r.speed,l++;x[t++]={startVertex:e,numberOfVertices:n.length,totalTime:n[n.length-1].t,timeSeed:d?m.getFloat():0}}return{lineVertices:g,lineDescriptors:x}}function ct(_,d=10){const{lineVertices:m,lineDescriptors:y}=_;let g=0,x=0;for(const o of y)g+=2*o.numberOfVertices,x+=6*(o.numberOfVertices-1);const l=new Float32Array(9*g),t=new Uint32Array(x);let n=0,e=0;function a(o,c,M,w,i,u,s,p){const h=9*n;let f=0;l[h+f++]=o,l[h+f++]=c,l[h+f++]=1,l[h+f++]=M,l[h+f++]=u,l[h+f++]=s,l[h+f++]=w/2,l[h+f++]=i/2,l[h+f++]=p,n++,l[h+f++]=o,l[h+f++]=c,l[h+f++]=-1,l[h+f++]=M,l[h+f++]=u,l[h+f++]=s,l[h+f++]=-w/2,l[h+f++]=-i/2,l[h+f++]=p,n++}for(const o of y){const{totalTime:c,timeSeed:M}=o;let w=null,i=null,u=null,s=null,p=null,h=null;for(let f=0;f<o.numberOfVertices;f++){const v=m[4*(o.startVertex+f)+0],A=m[4*(o.startVertex+f)+1],I=m[4*(o.startVertex+f)+2],T=m[4*(o.startVertex+f)+3];let P=null,O=null,k=null,E=null;if(f>0){P=v-w,O=A-i;const L=Math.sqrt(P*P+O*O);if(P/=L,O/=L,f>1){let b=P+p,D=O+h;const U=Math.sqrt(b*b+D*D);b/=U,D/=U;const F=Math.min(1/(b*P+D*O),d);b*=F,D*=F,k=-D,E=b}else k=-O,E=P;null!==k&&null!==E&&(a(w,i,u,k,E,c,M,T),t[e++]=n-2,t[e++]=n,t[e++]=n-1,t[e++]=n,t[e++]=n+1,t[e++]=n-1)}w=v,i=A,u=I,p=P,h=O,s=T}a(w,i,u,-h,p,c,M,s)}return{vertexData:l,indexData:t}}function C(_,d){const m=d.pixels,{width:y,height:g}=d,x=new Float32Array(y*g*2);if("vector-uv"===_)for(let l=0;l<y*g;l++)x[2*l+0]=m[0][l],x[2*l+1]=-m[1][l];else if("vector-magdir"===_)for(let l=0;l<y*g;l++){const t=m[0][l],n=(0,X.Vl)(m[1][l]),e=Math.cos(n-Math.PI/2),r=Math.sin(n-Math.PI/2);x[2*l+0]=e*t,x[2*l+1]=r*t}return{data:x,width:y,height:g}}function G(_,d,m,y,g,x){return tt.apply(this,arguments)}function tt(){return(tt=(0,Q.Z)(function*(_,d,m,y,g,x){const l=(0,K.C5)(d.spatialReference);if(!l)return ot(_,d,m,y,g,x);const[t,n]=l.valid,r=Math.ceil(d.width/(n-t)),a=d.width/r,o=Math.round(m/r);let c=d.xmin;const M=[];for(let s=0;s<r;s++){const p=new J.Z({xmin:c,xmax:c+a,ymin:d.ymin,ymax:d.ymax,spatialReference:d.spatialReference});M.push(ot(_,p,o,y,g,x)),c+=a}const w=yield Promise.all(M),i={data:new Float32Array(m*y*2),width:m,height:y};let u=0;for(const s of w){for(let p=0;p<s.height;p++)for(let h=0;h<s.width;h++)u+h>=m||(i.data[2*(p*m+u+h)+0]=s.data[2*(p*s.width+h)+0],i.data[2*(p*m+u+h)+1]=s.data[2*(p*s.width+h)+1]);u+=s.width}return i})).apply(this,arguments)}function ot(_,d,m,y,g,x){return R.apply(this,arguments)}function R(){return(R=(0,Q.Z)(function*(_,d,m,y,g,x){const l={requestProjectedLocalDirections:!0,signal:x};if((0,S.pC)(g)&&(l.timeExtent=g),"imagery"===_.type){yield _.load({signal:x});const e=_.rasterInfo.dataType,r=yield _.fetchImage(d,m,y,l);return!r||(0,S.Wi)(r.pixelData)||(0,S.Wi)(r.pixelData.pixelBlock)?{data:new Float32Array(m*y*2),width:m,height:y}:C(e,r.pixelData.pixelBlock)}yield _.load({signal:x});const t=_.rasterInfo.dataType,n=yield _.fetchPixels(d,m,y,l);return!n||(0,S.Wi)(n.pixelBlock)?{data:new Float32Array(m*y*2),width:m,height:y}:C(t,n.pixelBlock)})).apply(this,arguments)}}}]);