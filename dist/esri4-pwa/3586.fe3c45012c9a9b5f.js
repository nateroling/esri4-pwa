"use strict";var Rt=Object.defineProperty,jt=Object.defineProperties,Pt=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,Lt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,b=(v,c,o)=>c in v?Rt(v,c,{enumerable:!0,configurable:!0,writable:!0,value:o}):v[c]=o,C=(v,c)=>{for(var o in c||(c={}))Lt.call(c,o)&&b(v,o,c[o]);if(H)for(var o of H(c))Zt.call(c,o)&&b(v,o,c[o]);return v},x=(v,c)=>jt(v,Pt(c));(self.webpackChunkesri4_pwa=self.webpackChunkesri4_pwa||[]).push([[3586],{13586:(v,c,o)=>{o.r(c),o.d(c,{default:()=>Mt});var S=o(15861),l=o(17626),R=o(26584),Q=o(72392),m=o(62208),X=o(99959),k=o(10699),K=o(32917),y=o(77712),q=(o(85931),o(8314),o(90912),o(68653)),j=o(76898),_=o(22558),f=o(21726),tt=o(35948),et=o(34117),ot=o(31283);function P(t){return L[function rt(t){return t instanceof Blob?t.type:function it(t){const e=(0,f.Ml)(t);return Z[e]||z}(t.url)}(t)]||nt}const L={},z="text/plain",nt=L[z],Z={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const t in Z)L[Z[t]]=t;var h=o(29840);function J(t){const e=(0,m.pC)(t)&&t.origins?t.origins:[void 0];return(r,i)=>{const s=function st(t,e,r){if((0,m.pC)(t)&&"resource"===t.type)return function at(t,e,r){const i=(0,et.VZ)(e,r);return{type:String,read:(s,p,a)=>{const n=(0,h.r)(s,p,a);return i.type===String?n:"function"==typeof i.type?new i.type({url:n}):void 0},write:{writer(s,p,a,n){if(!n||!n.resources)return"string"==typeof s?void(p[a]=(0,h.t)(s,n)):void(p[a]=s.write({},n));const g=function dt(t){return(0,m.Wi)(t)?null:"string"==typeof t?t:t.url}(s),u=g?(0,h.t)(g,x(C({},n),{verifyItemRelativeUrls:n&&n.verifyItemRelativeUrls?{writtenUrls:n.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null}),h.M.NO):null,U=i.type!==String&&(!(0,_.l)(this)||n&&n.origin&&this.originIdOf(r)>(0,ot.M9)(n.origin));n&&n.portalItem&&(0,m.pC)(u)&&!(0,f.YP)(u)?U?function lt(t,e,r,i,s,p,a,n){const g=a.portalItem.resourceFromPath(i),u=F(r,i,a);P(u)===(0,f.Ml)(g.path)?(W(t,e,g,u,a.resources.toUpdate),s[p]=i):E(t,e,r,i,s,p,a,n)}(this,r,s,u,p,a,n,t):function pt(t,e,r,i){i.resources.toKeep.push({resource:i.portalItem.resourceFromPath(t)}),e[r]=t}(u,p,a,n):n&&n.portalItem&&((0,m.Wi)(u)||(0,m.pC)((0,h.i)(u))||(0,f.jc)(u)||U)?E(this,r,s,u,p,a,n,t):p[a]=u}}}}(t,e,r);switch((0,m.pC)(t)&&t.type?t.type:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:i,write:s}=h.p;return{read:i,write:s}}}}(t,r,i);for(const p of e){const a=(0,y.CJ)(r,p,i);for(const n in s)a[n]=s[n]}}}function E(t,e,r,i,s,p,a,n){const g=(0,tt.D)(),u=F(r,i,a),U=(0,f.v_)((0,m.U2)(n,"prefix"),g),Tt=`${U}.${P(u)}`,N=a.portalItem.resourceFromPath(Tt);(0,f.jc)(i)&&a.resources.pendingOperations.push(function yt(t){return A.apply(this,arguments)}(i).then(Nt=>{N.path=`${U}.${P(Nt)}`,s[p]=N.itemRelativeUrl}).catch(()=>{})),W(t,e,N,u,a.resources.toAdd),s[p]=N.itemRelativeUrl}function W(t,e,r,i,s){s.push({resource:r,content:i,finish:p=>{!function ct(t,e,r){"string"==typeof t[e]?t[e]=r.url:t[e].url=r.url}(t,e,p)}})}function F(t,e,r){return"string"==typeof t?{url:e}:new Blob([JSON.stringify(t.toJSON(r))],{type:"application/json"})}function A(){return(A=(0,S.Z)(function*(t){const e=(yield Promise.resolve().then(o.bind(o,84792))).default,{data:r}=yield e(t,{responseType:"blob"});return r})).apply(this,arguments)}var w,ut=o(63602),mt=o(50085),vt=o(65088),ft=o(49286),ht=o(6647),gt=o(99555),V=o(10157),St=o(13812),M=o(35031),Ot=o(84792),Ct=o(48701),G=o(86810),It=(o(29132),o(58817)),Ut=o(14889),xt=o(99433),$=o(54614),Y=o(37118);let O=w=class extends G.wq{constructor(t){super(t),this.geometry=null,this.type="clip"}writeGeometry(t,e,r,i){if(i.layer&&i.layer.spatialReference&&!i.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,$.Up)(t.spatialReference,i.layer.spatialReference))return void(i&&i.messages&&i.messages.push(new Ut.Z("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:i.layer.spatialReference,context:i})));const s=new Y.Z;(0,$.Wt)(t,s,i.layer.spatialReference),e[r]=s.toJSON(i)}else e[r]=t.toJSON(i);delete e[r].spatialReference}clone(){return new w({geometry:(0,It.d9)(this.geometry),type:this.type})}};(0,l._)([(0,y.Cb)({type:Y.Z}),J()],O.prototype,"geometry",void 0),(0,l._)([(0,xt.c)(["web-scene","portal-item"],"geometry")],O.prototype,"writeGeometry",null),(0,l._)([(0,y.Cb)({type:["clip","mask","replace"],nonNullable:!0}),J()],O.prototype,"type",void 0),O=w=(0,l._)([(0,j.j)("esri.layers.support.SceneModification")],O);const D=O;var I;let T=I=class extends((0,G.eC)(Ct.Z.ofType(D))){constructor(t){super(t),this.url=null}toJSON(t){return this.toArray().map(e=>e.toJSON(t)).filter(e=>!!e.geometry)}clone(){return new I({url:this.url,items:this.items.map(t=>t.clone())})}_readModifications(t,e){for(const r of t)this.add(D.fromJSON(r,e))}static fromJSON(t,e){const r=new I;return r._readModifications(t,e),r}static fromUrl(t,e,r){return(0,S.Z)(function*(){const i={url:(0,f.mN)(t),origin:"service"},s=yield(0,Ot.default)(t,{responseType:"json",signal:(0,m.U2)(r,"signal")}),p=e.toJSON(),a=[];for(const n of s.data)a.push(D.fromJSON(x(C({},n),{geometry:x(C({},n.geometry),{spatialReference:p})}),i));return new I({url:t,items:a})})()}};(0,l._)([(0,y.Cb)({type:String})],T.prototype,"url",void 0),T=I=(0,l._)([(0,j.j)("esri.layers.support.SceneModifications")],T);const B=T;let d=class extends((0,V.Vt)((0,vt.Y)((0,ft.q)((0,ht.I)((0,gt.M)((0,X.R)((0,mt.V)(ut.Z)))))))){constructor(...t){super(...t),this.handles=new Q.Z,this.geometryType="mesh",this.operationalLayerType="IntegratedMeshLayer",this.type="integrated-mesh",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile="mesh-pyramids",this.modifications=null,this._modificationsSource=null,this.elevationInfo=null,this.path=null}destroy(){this.handles.destroy()}initialize(){this.handles.add((0,K.on)(()=>this.modifications,"after-changes",()=>this.modifications=this.modifications,K.Z_))}normalizeCtorArgs(t,e){return"string"==typeof t?C({url:t},e):t}readModifications(t,e,r){this._modificationsSource={url:(0,h.f)(t,r),context:r}}load(t){var e=this;return(0,S.Z)(function*(){return e.addResolvingPromise(e._doLoad(t)),e})()}_doLoad(t){var e=this;return(0,S.Z)(function*(){const r=(0,m.U2)(t,"signal");try{yield e.loadFromPortal({supportedTypes:["Scene Service"]},t)}catch(i){(0,k.r9)(i)}if(yield e._fetchService(r),(0,m.pC)(e._modificationsSource)){const i=yield B.fromUrl(e._modificationsSource.url,e.spatialReference,t);e.setAtOrigin("modifications",i,e._modificationsSource.context.origin),e._modificationsSource=null}yield e._fetchIndexAndUpdateExtent(e.nodePages,r)})()}beforeSave(){if(!(0,m.Wi)(this._modificationsSource))return this.load().then(()=>{},()=>{})}saveAs(t,e){var r=this;return(0,S.Z)(function*(){return r._debouncedSaveOperations(V.xp.SAVE_AS,x(C({},e),{getTypeKeywords:()=>r._getTypeKeywords(),portalItemLayerType:"integrated-mesh"}),t)})()}save(){var t=this;return(0,S.Z)(function*(){const e={getTypeKeywords:()=>t._getTypeKeywords(),portalItemLayerType:"integrated-mesh"};return t._debouncedSaveOperations(V.xp.SAVE,e)})()}validateLayer(t){if(t.layerType&&"IntegratedMesh"!==t.layerType)throw new R.Z("integrated-mesh-layer:layer-type-not-supported","IntegratedMeshLayer does not support this layer type",{layerType:t.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new R.Z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(this.version.major>1)throw new R.Z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"})}_getTypeKeywords(){return["IntegratedMeshLayer"]}};(0,l._)([(0,y.Cb)({type:String,readOnly:!0})],d.prototype,"geometryType",void 0),(0,l._)([(0,y.Cb)({type:["show","hide"]})],d.prototype,"listMode",void 0),(0,l._)([(0,y.Cb)({type:["IntegratedMeshLayer"]})],d.prototype,"operationalLayerType",void 0),(0,l._)([(0,y.Cb)({json:{read:!1},readOnly:!0})],d.prototype,"type",void 0),(0,l._)([(0,y.Cb)({type:M.U4,readOnly:!0})],d.prototype,"nodePages",void 0),(0,l._)([(0,y.Cb)({type:[M.QI],readOnly:!0})],d.prototype,"materialDefinitions",void 0),(0,l._)([(0,y.Cb)({type:[M.Yh],readOnly:!0})],d.prototype,"textureSetDefinitions",void 0),(0,l._)([(0,y.Cb)({type:[M.H3],readOnly:!0})],d.prototype,"geometryDefinitions",void 0),(0,l._)([(0,y.Cb)({readOnly:!0})],d.prototype,"serviceUpdateTimeStamp",void 0),(0,l._)([(0,y.Cb)({type:B}),J({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],d.prototype,"modifications",void 0),(0,l._)([(0,q.r)(["web-scene","portal-item"],"modifications")],d.prototype,"readModifications",null),(0,l._)([(0,y.Cb)(St.PV)],d.prototype,"elevationInfo",void 0),(0,l._)([(0,y.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],d.prototype,"path",void 0),d=(0,l._)([(0,j.j)("esri.layers.IntegratedMeshLayer")],d);const Mt=d}}]);